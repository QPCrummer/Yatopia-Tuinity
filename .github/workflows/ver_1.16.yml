# This is a basic workflow to help you get started with Actions

name: ver/1.16

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the master branch
on:
  push:
    branches: [ scripts ]
  schedule:
    - cron:  '0 */1 * * *'

jobs:
  build:
    runs-on: ubuntu-20.04
    steps:
    - uses: actions/setup-java@v1
      with:
        java-version: 11
    - name: Run
      env:
        GIT_ID_RSA: ${{ secrets.GIT_ID_RSA }}
      run: |
        mkdir -p ~/.ssh
        ssh-keyscan -H -t rsa github.com > ~/.ssh/known_hosts
        echo "$GIT_ID_RSA" > ~/.ssh/id_rsa
        git config --global user.email tsao-chi@the-lingo.org
        git config --global user.name 'ㄗㄠˋ ㄑㄧˊ'
        git clone -b ver/1.16 https://github.com/Spottedleaf/Tuinity.git ~/Tuinity
        cd ~/Tuinity
        ./tuinity patch
        cd Paper
        git pull origin ver/1.16
        cd ..
        git add Paper
        ./tuinity patch
        ./tuinity rebuild
        git add .
        ./scripts/upstreamCommit.sh
        git push --force git@github.com:tsao-chi/Tuinity-autoupstreamupdate.git
